 <!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{/user/index :: dynamic(~{::main})}">
<body ng-controller="shopping-cart-ctrl" >
	<main>
		<!-- Breadcrumb Section Begin -->
	    <section class="breadcrumb-section set-bg" data-setbg="/assets/img/breadcrumb.jpg">
	        <div class="container">
	            <div class="row">
	                <div class="col-lg-12 text-center">
	                    <div class="breadcrumb__text">
	                        <h2>Tastybites Shop</h2>
	                        <div class="breadcrumb__option">
	                            <a th:href="@{/home/index}">Home</a>
	                            <span>Shop</span>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </section>
	    <!-- Breadcrumb Section End -->
	
	    <!-- Product Section Begin -->
	    <section class="product spad">
	        <div class="container">
	            <div class="row">
	                <div class="col-lg-3 col-md-5">
	                    <div class="sidebar">
	                       <!-- Price Start -->
					
					<div  class="bg-light p-4 mb-30">
						<form th:action="@{/product/list/filter}" method="get">
						<h5 class="section-title position-relative text-uppercase mb-3"><span
							>Filter by price</span></h5>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="all" value="true" class="custom-control-input" id="price-all">
								<label class="custom-control-label" for="price-all">All Price</label>
							</div>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="0-50000" value="true" class="custom-control-input" id="price-1">
								<label class="custom-control-label" for="price-1">0Đ - 50.000đ</label>
							</div>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="50000-100000" value="true" class="custom-control-input" id="price-2">
								<label class="custom-control-label" for="price-2">50.000đ - 100.000đ</label>
							</div>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="100000-200000" value="true" class="custom-control-input" id="price-3">
								<label class="custom-control-label" for="price-3">100.000đ-200.000đ</label>
							</div>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="200000-300000" value="true" class="custom-control-input" id="price-4">
								<label class="custom-control-label" for="price-4">200.000đ-300.000đ</label>
							</div>
							<div
								class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3">
								<input onclick="updateCheckboxes(this)" type="checkbox" name="300000-500000" value="true" class="custom-control-input" id="price-5">
								<label class="custom-control-label" for="price-5">300.000đ-500.000đ</label>
							</div>

							<input style="width: 100%" class="btn btn-filter px-3" type="submit" value="Filter" />
						</form>
					</div>

	                        <div class="sidebar__item">
	                            <div class="latest-product__text">
			                        <h4>Đánh Giá Cao</h4>
			                        <div class="latest-product__slider owl-carousel">
			                            <div class="latest-prdouct__slider__item" th:each="product, iterStat : ${productsTop}" th:if="${iterStat.index % 3 == 0}">
							                <div class="latest-product__item-group">
							                    <a th:href="@{|/product/detail/${product.id}|}" class="latest-product__item">
							                        <div class="latest-product__item__pic" style="width: 40%">
							                            <img th:src="@{|/assets/img/product/${product.image}|}" alt="">
							                        </div>
							                        <div class="latest-product__item__text">
							                            <h6 th:text="${product.name}"></h6>
							                            <span th:text="${#numbers.formatDecimal(product.price, 0, 'POINT', 0, 'POINT')}">
							                                &nbsp<span style="text-decoration: underline; color: #252525; font-weight: 700;">đ</span>
							                            </span>
							                        </div>
							                    </a>
							                </div>
							                <th:block th:if="${iterStat.index + 1 &lt; productsTop.size()}">
							                    <div class="latest-product__item-group">
							                        <a th:href="@{|/product/detail/${productsTop[iterStat.index + 1].id}|}" class="latest-product__item">
							                            <div class="latest-product__item__pic" style="width: 40%">
							                                <img th:src="@{|/assets/img/product/${productsTop[iterStat.index + 1].image}|}" alt="">
							                            </div>
							                            <div class="latest-product__item__text">
							                                <h6 th:text="${productsTop[iterStat.index + 1].name}"></h6>
							                                <span th:text="${#numbers.formatDecimal(productsTop[iterStat.index + 1].price, 0, 'POINT', 0, 'POINT')}">
							                                    &nbsp<span style="text-decoration: underline; color: #252525; font-weight: 700;">đ</span>
							                                </span>
							                            </div>
							                        </a>
							                    </div>
							                </th:block>
							                <th:block th:if="${iterStat.index + 2 &lt; productsTop.size()}">
							                    <div class="latest-product__item-group">
							                        <a th:href="@{|/product/detail/${productsTop[iterStat.index + 2].id}|}" class="latest-product__item">
							                            <div class="latest-product__item__pic" style="width: 40%">
							                                <img th:src="@{|/assets/img/product/${productsTop[iterStat.index + 2].image}|}" alt="">
							                            </div>
							                            <div class="latest-product__item__text">
							                                <h6 th:text="${productsTop[iterStat.index + 2].name}"></h6>
							                                <span th:text="${#numbers.formatDecimal(productsTop[iterStat.index + 2].price, 0, 'POINT', 0, 'POINT')}">
							                                    &nbsp<span style="text-decoration: underline; color: #252525; font-weight: 700;">đ</span>
							                                </span>
							                            </div>
							                        </a>
							                    </div>
							                </th:block>
							            </div>    
			                        </div>
			                    </div>
	                        </div>
	                    </div>
	                </div>
	                <div class="col-lg-9 col-md-7">
	                    <div class="product__discount">
	                        <div class="section-title product__discount__title">
	                            <h2>Sản Phẩm Mới</h2>
	                        </div>
	                        <div class="row">
	                            <div class="product__discount__slider owl-carousel">
	                                <div class="col-lg-4" th:each="product : ${productsNew}">
	                                    <div class="product__discount__item">
	                                        <div class="product__discount__item__pic set-bg w-100"
	                                            th:data-setbg="@{|/assets/img/product/${product.image}|}">
	                                            <div class="product__discount__percent">NEW</div>
	                                            <ul class="product__item__pic__hover">
	                                                <li><a href="#"><i class="fa fa-heart"></i></a></li>
	                                                <li><a th:href="@{|/product/detail/${product.id}|}"><i class="fa-solid fa-circle-info"></i></a></li>
	                                        		<li><a th:attr="ng-click=@{|cart.add(${product.id})|}"><i class="fa fa-shopping-cart"></i></a></li>
	                                            </ul>
	                                        </div>
	                                        <div class="product__discount__item__text">
	                                            <span th:text="${product.category.name}"></span>
	                                            <h5><a th:text="${product.name}"></a></h5>
	                                           <div class="row" style="display: flex; justify-content: center;">
												    <h5 style="font-weight: 700" th:text="${#numbers.formatDecimal(product.price, 0, 'POINT', 0, 'POINT')}"></h5>
												    &nbsp<span style="text-decoration: underline; color: #252525; font-weight: 700;">đ</span>
												</div>

	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                    <div class="filter__item">
	                        <div class="row">
	                            <div class="col-lg-4 col-md-5">

	                            </div>
	                            <div class="col-lg-4 col-md-4">
	                                <div class="filter__found">
	                                   <h6><span th:text="${items.size()}"></span> Products found</h6>
	                                </div>
	                            </div>
	                            <div class="col-lg-4 col-md-3">
	                                <div class="filter__option">
	                                    <span class="icon_grid-2x2"></span>
	                                    <span class="icon_ul"></span>
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                    <div class="row">
	                        <div class="col-lg-4 col-md-6 col-sm-6" th:each="p : ${items}">
	                            <div class="product__item">
	                                <div class="product__item__pic set-bg" th:data-setbg="@{|/assets/img/product/${p.image}|}">
	                                    <ul class="product__item__pic__hover">
	                                        <li><a href="#"><i class="fa fa-heart"></i></a></li>
	                                        <li><a th:href="@{|/product/detail/${p.id}|}"><i class="fa-solid fa-circle-info"></i></a></li>
	                                        <li><a th:attr="ng-click=@{|cart.add(${p.id})|}"><i class="fa fa-shopping-cart"></i></a></li>
	                                    </ul>
	                                </div>
	                                <div class="product__item__text">
	                                    <h6><a href="#" th:text="${p.name}"></a></h6>
	                                    <div class="row" style="display: flex; justify-content: center;">
										  <h5 th:text="${#numbers.formatDecimal(p.price, 0, 'POINT', 0, 'POINT')}"></h5>
										  &nbsp<span style="text-decoration: underline; color: #252525; font-weight: 700;">đ</span>
										</div>                          
	                                </div>
	                            </div>
	                        </div>
	                    </div>
	                    
	                    <div class="col-12">
				    		<ul class="pagination justify-content-center">
								<th:block th:if="${currentPage == 1}">
									<li class="page-item">
					            		<a class="page-link" style="cursor: pointer;color: #007bff;" disabled>Previous</a>
					        		</li>
								</th:block>
								<th:block th:if="${currentPage > 1}">
					        		<!-- Prev -->
					        		<li class="page-item">
					            		<a class="page-link" style="cursor: pointer;" th:href="@{/product/list(page=${currentPage - 1})}">Previous</a>
					        		</li>	
								</th:block>
				
								<th:block th:if="${maxPages == 0}">
									<li class="page-item">
				            			<a class="page-link" style="cursor: pointer;color: #007bff;">1</a>
					        		</li>
								</th:block>
								<th:block th:if="${maxPages > 0}">
					        		<li class="page-item" th:each="pageNum : ${#numbers.sequence(1, maxPages)}">
					            		<a class="page-link" style="cursor: pointer;" th:href="@{/product/list(page=${pageNum})}" th:classappend="${pageNum == currentPage} ? 'active'">[[${pageNum}]]</a>
					        		</li>	
								</th:block>
				
								<th:block th:if="${currentPage < maxPages}">
					        		<li class="page-item">
					            		<a class="page-link" style="cursor: pointer;" th:href="@{/product/list(page=${currentPage + 1})}">Next</a>
					        		</li>
				        		</th:block>
				        		<th:block th:unless="${currentPage < maxPages}">
					        		<li class="page-item">
					            		<a class="page-link" style="cursor: pointer;color: #007bff;" disabled>Next</a>
					        		</li>
				        		</th:block>
				    		</ul>
						</div>
	                </div>
	            </div>
	        </div><!-- Hàm JavaScript để xử lý sự kiện chỉ cho phép người dùng chọn duy nhất 1 checkbox. -->
		<script>
		function updateCheckboxes(clickedCheckbox) {
				var checkboxes = document.querySelectorAll("[id^='price-']");
				for (var i = 0; i < checkboxes.length; i++) {
			    	if (checkboxes[i] != clickedCheckbox) {
			      		checkboxes[i].checked = false;
			    	}
			 	}
			}
		</script>
	    </section>
	    <!-- Product Section End -->
	    
	</main>
</body>
</html>